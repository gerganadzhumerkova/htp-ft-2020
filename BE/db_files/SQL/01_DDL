create table articles
(
      id integer primary key autoincrement,
      insert_date datetime,
      last_updated_date datetime,
      first_published_date datetime,
      author text,
      title text,
      subtitle text,
      content text,
      evergreen_flag boolean,
      score_from_author text,
      front_page_flag boolean,
      initial_score real,
      number_purchased integer,
      number_upvotes integer,
      number_downvotes integer,
      current_score integer
);

create view articles_with_score as
with decayed as
(
  select *,
    current_score*exp(-0.0990 *(julianday('now') - julianday(last_updated_date)) * 86400.0/(24*60*60)) as current_score_with_decay
  from articles
)
select
    id,
    insert_date,
    last_updated_date,
    first_published_date,
    author,
    title,
    subtitle,
    content,
    evergreen_flag,
    score_from_author,
    front_page_flag,
    initial_score,
    number_purchased,
    number_upvotes,
    number_downvotes,
    -6.63+2.56*log(current_score_with_decay) as current_score,
    0.000491* (current_score_with_decay) +0.599 as current_price
FROM decayed;